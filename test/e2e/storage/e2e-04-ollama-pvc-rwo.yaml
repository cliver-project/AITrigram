---
# E2E Test: ModelRepository with PVC ReadWriteOnce (RWO) storage for Ollama
# Uses the cluster's default storage class
# Works with most storage classes: AWS EBS (gp2/gp3), GCP PD, Azure Disk, local-path, etc.
# The model download and LLMEngine pods will be pinned to the same node
#
# Note: The PVC will be automatically created by the controller in the
# aitrigram-system namespace (where the controller runs)
# The download job will bind to a node, and status.boundNodeName will be set

apiVersion: aitrigram.cliver-project.github.io/v1
kind: ModelRepository
metadata:
  name: ollama-pvc-rwo-test
spec:
  source:
    origin: ollama
    modelId: qwen2.5:0.5b  # Small model for faster testing

  storage:
    type: PersistentVolumeClaim
    mountPath: /data/models
    persistentVolumeClaim:
      size: 2Gi
      accessMode: ReadWriteOnce
      # storageClassName not specified - uses cluster default storage class

  autoDownload: true

  # Optional: Uncomment to force specific node
  # nodeSelector:
  #   kubernetes.io/hostname: worker-node-1
